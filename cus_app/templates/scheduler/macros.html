{% macro schedule_row(schedule, form) %}
    {% set locked = schedule.user_id != None %}
    <tr>
        {% if locked %}
            <td><b>{{ schedule.user.full_name }}</b></td>
        {% else %}
            <td><b>{{ form.user() }}</b></td>
        {% endif %}
        {{ display_time_cell(form, 'start', locked) }}
        {{ display_time_cell(form, 'stop', locked) }}
        {% if locked %}
            <td>{{ form.unlock() }}</td>
            <td colspan=2>&#160;</td>
        {% else %}
            <td>{{ form.update() }}</td>
            <td colspan=2>{{ form.split() }} {{ form.delete() }}</td>
        {% endif %}
    </tr>
{% endmacro %}

{% macro display_time_cell(form, set, locked) %}
    {% if locked %}
        {% for col in ('month', 'day', 'year')%}
            <td>{{ form[set + '_' + col].data }}</td>
        {% endfor %}
    {% else %}
        {% for col in ('month', 'day', 'year')%}
            <td>{{ form[set + '_' + col]() }}</td>
        {% endfor %}
    {% endif%}
{% endmacro %}