##
##--- table header
##

{% macro table_header() %}
    <tr>
        <th style='width:25%;'>Parameter</th>
        <th style='width:25%;'>Original Value</th>
        <th style='width:25%;'>Requested Value</th>
        <th style='width:25%;'>Current DB Value</th>
    </tr>
{% endmacro %}

##
##--- color coded table cell
##

{% macro color_coded(org, req, ocat, change_requested) %}
    {% if change_requested and req == ocat%}
        <td style='background-color:rgb(124,252,0,0.3);'>{{ ocat }}</td>
    {% elif not change_requested and org != ocat %}
        <td style='background-color:rgb(255,0,255,0.3);'>{{ ocat }}</td>
    {% elif change_requested and req != ocat %}
        <td style='background-color:rgb(255,69,0, 0.3);'>{{ ocat }}</td>
    {%else %}
        <td>{{ ocat }}</td>
    {% endif %}
{% endmacro %}

##
##--- top comment section
##

{% macro check_two_entries(param, org_dict, req_dict, ocat_data, _LABELS) %}
    {% if org_dict.get(param) %}
        <h3> Past {{ _LABELS.get(param) }}</h3>
            <p>{{ org_dict.get(param) }}</p>
        {% if req_dict.get(param) %}
        <h3 style='color:rgb(255,0,0,0.6);'>New {{ _LABELS.get(param) }}</h3>
            {% if req_dict.get(param) != None %}
                <p>{{ req_dict.get(param) }}</p>
            {% else %}
                <p> NA </p>
            {% endif %}
        {% endif %}

    {% elif req_dict.get(param) %}
        <h3>Past {{ _LABELS.get(param) }}</h3>
            <p> NA </p>
        <h3 style='color:rgb(255,0,0,0.6);'>New {{ _LABELS.get(param) }}</h3>
            <p>{{ req_dict.get(param) }}</p>
    {% endif %}
{% endmacro %}

##
##--- table for standard parameter cases
##

{% macro param_block(org_dict, req_dict, ocat_data, p_list, title) %}
    <div style='padding-top:10px;'></div>
    <table border=1 width=100%>
    <col style='width:25%' span="4">
    <tr><th colspan=4 style='background-color:rgb(255,204, 255,0.5);'>{{ title }}</th></tr>
    {{ table_header() }}
    {% for param in p_list %}
        <tr>
            <th>{{ param.upper() }} </th>
            <td>{{ org_dict.get(param) }}</td>
            {%if param in req_dict.keys()%}
                <td>{{ req_dict.get(param) }}</td>
            {% else %}
                <td>{{ org_dict.get(param) }}</td>
            {% endif%}
            {{ color_coded(org_dict.get(param), req_dict.get(param), ocat_data.get(param), param in req_dict.keys()) }}
        </tr>
    {% endfor %}
    </table>
{% endmacro %}

##
##---  table for ordered cases
##

{% macro ordr_block(org_dict, req_dict, ocat_data, order_param, rank_name, title) %}

    <div style='padding-top:10px;'></div>
    <table border=1 width=100%>
    <col style='width:25%' span="4">
    <tr><th colspan=4 style='background-color:rgb(255,204, 255,0.5);'>{{ title }}</th></tr>
    {{ table_header() }}
    {% if org_dict.get(order_param) == 0 and req_dict.get(order_param) == 0 and ocat_data.get(order_param) == 0 %}
        <tr><th>{{ order_param }}</th>
        <td>0</td><td>0</td><td>0</td>
        </tr>
    {% else %}
        <tr>
            <th>{{ order_param.upper() }}</th>
            <td>{{ org_dict.get(order_param) }}</td>
            <td>{{ req_dict.get(order_param) }}</td>
            {{ color_coded(org_dict.get(order_param), req_dict.get(order_param), ocat_data.get(order_param), org_dict.get(order_param) != req_dict.get(order_param)) }}
        </tr>
        {% for ordr, param, (org,req,ocat) in IterateRecords(org_dict.get(rank_name),req_dict.get(rank_name),ocat_data.get(rank_name)) %}
            <tr>
                <th>{{ param.upper() }} order={{ ordr + 1 }} </th>

                <td>{{ org }}</td>
                <td>{{ req }}</td>
                {{ color_coded(org, req, ocat, org != req) }}
            </tr>
        {% endfor %}
    {% endif %}
    </table>
{% endmacro %}

###
###--- changed param table 
###

{% macro changed_param(org_dict, req_dict, _LABELS, _PARAM_SET, title) %}

{% if set(req_dict.keys()).intersection(_PARAM_SET) != set() %}
    <table border=1 style='width:75%;'>
        <tr><th colspan=3 style='background-color:rgb(255,204, 255,0.5);'>{{ title }}</th></tr>
        {% for param in set(req_dict.keys()).intersection(_PARAM_SET) %}
            <tr>
            <th style='width:33%;'> {{ param.upper() }} </th>
            <td style='width:33%;'> {{ org_dict.get(param) }}
            <td style='width:33%;'> {{ req_dict.get(param) }}
            </tr>
        {% endfor %}
    </table>
{% endif %}

{% endmacro %}

